# Backend
웹형 기숙사 DMS(document management system) 문서 관리 시스템 백엔드

url: "[http://domidomi.duckdns.org]()"

**초기 데이터**

#### 회원

- email: [eeee@email.com]() | pwd: pppp
- email: [eeee1@email.com]() | pwd: pppp
- email: [eeee2@email.com]() | pwd: pppp

#### 카테고리

- 1~7번 카테고리(이미지타입), 8번 카테고리(텍스트+이미지타입, 상세기능 미구현)

#### 게시글

- 1번 카테고리의 이미지타입 게시글 100개를 등록해놓았으므로 페이지네이션 구현할때 사용하시면 됨.
  (이미지타입 게시글 등록시 사진첨부를 요구하지만, 더미데이터에는 편의상 사진을 넣지 않았음)
  \*\* 0818 현재 구현된 게시글 업로드/조회 기능은 '이미지타입' 뿐임.

### 즐겨찾기

- 1번 유저 (eeee@email.com)에게 1~7번 카테고리가 모두 이미 즐겨찾기 추가되어 있음.
  테스트 시 1번 유저로 테스트하는 것을 추천.

# 23.09.07

### **주 변경점**

1. 미수령 택배 관리대장 요청 url 변경 (불필요한 카테고리 명시 생략)
2. 미수령 택배 기능 추가

- 수정
- 삭제

3. 민원처리내역 기능 추가

- 등록
- 수정
- 삭제
- 목록조회
- **호실 검색, (처리내역&&처리결과) 검색은 추가할 예정**

### 추가된 API 목록

<u>게시글/미수령택배</u>

- 수정
- 삭제

<u>게시글/민원처리내역</u>

- 등록
- 수정
- 삭제
- 목록조회

### 수정된 API 목록

<u>게시글/미수령택배</u>

아래 3가지 요청의 url 변경

1. 관리물품 등록
   /posts/undelivered-parcel/{postId}
2. 상세조회
   /posts/undelivered-parcel/{postId}
3. 미수령택배 게시글 삭제
   /posts/undelivered-parcel/{postId}

# 23.09.03

### **주 변경점**

1. 게시글 페이지 사이즈 변경 6 -> 20
2. 게시글 단건 조회시에도 url에 카테고리 포함하도록 변경
3. 장기 미수령 어쩌구 API 추가

- 게시글 목록조회
- 게시글 등록
- 게시글 삭제
- 게시글 상세조회
- 관리물품 등록

### 추가된 API 목록

<u>게시글/미수령택배</u>

- 게시글 목록조회
- 게시글 등록
- 게시글 삭제
- 게시글 상세조회
- 관리물품 등록

### 수정된 API 목록

<u>게시글/이미지타입</u>

- 단건조회 (url에 카테고리 ID 포함)
- 목록조회 (페이지 사이즈 20)

### 특이사항

1. 미수령 택배 관리대장 게시판은 url상에서 "undelivered-parcel"로 칭하기로 함.
2. 해당 폴더에서 공통적으로 발생 가능한 예외는 일일히 예시를 등록하지 않고 따로 뺐음. '게시글/공통 예외사항' 혹은 루트 폴더의 '인증 실패 예시' 참조.
3. 상세조회 시에 각 관리물품의 최종 수정자와 최종 수정시간을 같이 반환하는데, 이건 필요한가요?
4. 어떤 API에서는(이미지타입 게시글 목록) 최초 생성자와 최초 생성시간,
   어떤 API에서는(미수령택배 게시글 목록) 최종 수정자와 최종 수정시간을 반환하도록 되어있는데,
   각 화면에 어떤 데이터가 필요한지 정하는게 필요할 듯?

# 23.08.31

### **주 변경점**

Refresh Token 기능 활성화,
로그아웃 기능 추가,
토큰 관련 json 필드명 일부 변경

### 추가된 API 목록

<u>사용자 인증</u>

- 로그인V2
- 토큰 재발급
- 로그아웃

### 수정된 API 목록

<u>사용자 인증</u>

- 로그인 // json 필드명만 변경

### 특이사항

1. 로그인 시 반환 필드명이 아래의 주석과 같이 수정됨.

```json
{
  "code": 200,
  "message": "로그인 성공!",
  "data": {
    "authScheme": "Bearer", // grantType -> authScheme
    "accessToken": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJBQ0NFU1MiLCJhdWQiOiJlZWVlQGVtYWlsLmNvbSIsImlhdCI6MTY5MzQxMjg2NCwiZXhwIjoxNjk0NjIzMzY0fQ.QJeZvJyj0DzghGP3fSMrB0MD4B9z5zHOtzrime5q_fLTa7zdtlQTirnWk0Q1a6gmoN2Xt-SWlDZr2T8Z40orpA",
    "accessTokenExp": "2023-09-14 01:42:44", // ExpirationTime -> Exp
    "refreshToken": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJSRUZSRVNIIiwiYXVkIjoiZWVlZUBlbWFpbC5jb20iLCJpYXQiOjE2OTM0MTI4NjQsImV4cCI6MTY5NDYyMzM2NH0.f6aqgyvi9Jthh2jMvlYR7FIXxnB0bqbTBjh5sVyOhb-cxdk4oFb4ODdt2BpUXxw581ugGe2UlCLgaQ7hdX4xBw",
    "refreshTokenExp": "2023-09-14 01:42:44", // ExpirationTime -> Exp
    "username": "name1",
    "role": "Admin"
  }
}
```

2. 로그인V2는 뭐임??

토큰 재발급 테스트를 위해 액세스 토큰의 유효시간을 10초, 리프레시 2주로 설정한 API
기존 사용중이던 로그인 API를 그대로 사용할 수 있게 하기 위해 V2로 따로 만들었고,
프론트단 토큰 재발급 로직이 안정화되면 그때 V2만을 사용하고 액세스 토큰 유효시간을 15분정도로 만들 계획임.

3. 로그아웃은 뭘 하는건가요

DB의 리프레시 토큰을 제거합니다.
서버는 토큰 상태를 리프레시 토큰만 기억하므로 액세스 토큰은 무효화할 수 없음.

그래서 프론트쪽에서는 access token을 비워두면 될 듯.

4. 토큰 재발급 관련

액세스 토큰에 대해 401 응답이 오면
리프레시 토큰 재발급 API를 호출해 새 토큰 쌍을 받아오는 식으로 하면 될 듯.(refresh 토큰은 1회용이라 재발급받을때 두 쌍을 한꺼번에 저장해야 함)
이거 구현하려면 Axios interceptor같은걸 쓴다는데 잘 모름

# 23.08.28

### **주 변경점**

즐찾 조회시 최근 추가한 순으로 반환

# _23.08.25_

### 주 변경점

이미지타입 게시글 수정/삭제

### 추가된 API 목록

<u>게시글/이미지타입</u>

- 수정 (글 제목과 이미지를 수정하며, 수정 권한을 검사하지 않습니다.)
- 삭제 (현재 삭제 권한 검사 X)

### 특이사항

HTTP 요청을 보낼 때 값의 검증이 실패할 경우 응답값이 바뀜.
만약 아래에서 title값의 검증만 통과했을 경우 title필드는 사라지는 방식.

```json
{
  "statusCode": 400,
  "httpStatus": "Bad Request",
  "errorMessage": {
    "title": "제목은 비어있을 수 없습니다. 요청받은 값: null",
    "postImages": "이미지는 비어있을 수 없습니다. 요청받은 값: null"
  }
}
```

# _23.08.24_

### 주 변경점

게시글 목록조회에 카테고리 정보 추가,
즐겨찾기 여부를 포함한 카테고리 목록 조회 기능 추가

\+ 비밀번호 찾기 오류 수정

### 추가된 API 목록

<u>즐겨찾기</u>

- 즐겨찾기 여부를 포함한 조회

### 수정된 API 목록

<u>게시글/이미지타입</u>

- 목록조회 - 'category' 객체 추가

### 특이사항

카테고리 목록을 반환하는 비슷한 API 두 개가 있음.

- 즐겨찾기 여부를 포함한 조회 - nav bar에서 사용
- 카테고리 목록조회 - 관리페이지에서 사용하면 될 듯

# _23.08.21_

### 주 변경점

즐겨찾기 추가/취소, 즐겨찾기 목록 조회 기능 추가

### 추가된 API 목록

_즐겨찾기_

- 즐찾 추가/취소 [POST]
- 즐찾 목록 조회 [GET]

### 수정된 API 목록

X

### 특이사항

<u>좋아해요<u>

# _23.08.18_

### 주 변경점

이미지타입 게시글이 카테고리에 소속되지 않았던 오류 수정

### 추가된 API 목록

X

### 수정된 API 목록

- 게시글/이미지타입 폴더 내의
  '업로드, 목록조회' url에서 카테고리를 특정하도록 변경

### 특이사항

현재 카테고리 생성시 타입을

- IMAGE
- TEXT_IMAGE

로 지정 가능함.
실제로 구현된 게시글 기능은 현재 IMAGE만 되어있음.

# _23.08.17_

### 주 변경점

인증/인가 에러 응답값 표준화

### 추가된 API 목록

X

### 수정된 API 목록

인증을 요구하는 모든 API에 영향

### 특이사항

- 현재 403은 발생하지 않음.

# _23.08.16_

### 주 변경점

이미지타입 게시글의 생성/목록조회/단건조회 API 추가

### 추가된 API 목록

게시글/이미지타입

- 업로드
- 목록조회
- 단건조회
- 이미지 조회

### 수정된 API 목록

X

### 특이사항

- '단건조회' 의 응답값에 있는 파일명을 '이미지 조회' 의 파라미터로 넣어야 이미지 조회 가능  
  예) "img src='{domain}/posts/image-types/images?filename=ee52-...77.jpg'"
- 목록조회는 페이지네이션이 적용되어있음. 해당 부분 문서 참고

# 23.08.14

### 주 변경점

/user/login API의 반환값 필드 username, role을 아래와 같이 추가함

```json
    "message": "로그인 성공!",
    "data": {
    "grantType": "생략",
    "accessToken": "생략",
    "accessTokenExpireTime": "생략",
    "refreshToken": "생략",
    "refreshTokenExpireTime": "생략",
    // 추가된 데이터
    "username": "name2",
    "role": "ADMIN"
    }

```

### 추가된 API 목록

X

### 수정된 API 목록

사용자 회원가입/로그인

# _23.08.13_

### 주 변경점

#### 1\. 입사생 데이터 중복판단기준 변경

**기존의 중복 데이터 판단 기준**

- Resident 테이블에서 학번과 이름 모두 Unique 처리.

**변경된 데이터 중복 판단 기준**

- (학번+거주학기) 의 묶음을 Unique 처리.

#### 2\. 데이터 생성자, 마지막 변경자 기록 (로그인한 사용자의 email이 기록됨)

### 추가된 API 목록

X

### 수정된 API 목록

입사생 추가

- \[POST\] /residents | 데이터 중복 실패 케이스 추가

# _23.08.09_

### 주 변경점

데이터 날아감

### 추가된 API 목록

카테고리

### 수정된 API 목록

X

### 특이사항

생성 시 'categoryType' 파라미터는 현재  
\[PHOTO_UPLOAD, WRITE_POST\] 두 개 중에 하나를 선택해야 함.

# _23.08.07_

### 주 변경점

아니 이거 문서 날라갔는데?

### 추가된 API 목록

X

### 수정된 API 목록

PDF

- PDF 벌크업로드 \[POST\] -> 'pdfType' 파라미터 추가
- PDF 단건업로드 \[POST\] -> 'pdfType' 파라미터 추가
- PDF 단건조회 \[GET\] -> 'pdfType' 파라미터 추가 (url query param)

**특이사항**  
'pdfType' 파라미터는  
\[ADMISSION, DEPARTURE\] 둘 중 하나를 선택해야 함

# _23.08.02_

### 주 변경점

### 추가된 API 목록

PDF

- PDF 벌크업로드 \[POST\]
- PDF 단건업로드 \[POST\]
- PDF 단건조회 \[GET\]

### 수정된 API 목록

X

# _23.07.26_

### 주 변경점

1. 임시 비밀번호 전송
2. 비밀번호 변경

### 추가된 API 목록

사용자 회원가입,로그인

- 임시 비밀번호 전송

### 수정된 API 목록

X  
**특이사항**  
현재 회원가입 시 이메일 인증여부를 검사하는 로직이 누락됨

# _23.07.25_

### 주 변경점

1. 학번 UUID 반환 오류 수정. 이제 숫자로 반환됨
2. 퇴관일시 빈칸처리.

### 수정된 API 목록

입사생

- 입사생 목록 조회 (반환형식만 변경)
- 입사생 추가 (빈 퇴사일시 지정방식 변경)

**특이사항**

- 엑셀 파일상의 빈 '퇴관일시'셀은 업로드 시 웹상에서 빈칸으로 표시됨.

# _23.07.19_

### 주 변경점

사용자 로그인/회원가입 기능 추가

###추가된 API 목록  
사용자 회원가입/로그인 폴더에 있는 API 전체

- 회원가입
- 로그인
- accesstoken으로 유저 정보 확인
- 이메일 인증코드 전송

### 특이사항

- 현재 회원가입 시 이메일 인증여부를 검사하는 로직이 누락됨

# _23.07.15_

### 추가된 API 목록

- 입사생 추가
- 입사생 정보 수정

### 변경된 API 목록

X

### 주 변경점

거주기간(residenceSemester) 기능이 추가됨. 다음의 경우 파라미터 명시 필요

- 엑셀 업로드 시
- 입사생 목록 조회 시
- 입사생 추가 시

**특이사항**

**요청 파라미터에서 거주기간의 값은 다음 값 중 하나와**  
**반드시 일치해야 서버에서 해석 가능**  
S2023_1, S2023_SUMMER, S2023_2, S2023_WINTER,  
S2024_1, S2024_SUMMER, S2024_2, S2024_WINTER,  
S2025_1, S2025_SUMMER, S2025_2, S2025_WINTER,  
S2026_1, S2026_SUMMER, S2026_2, S2026_WINTER,  
S2027_1, S2027_SUMMER, S2027_2, S2027_WINTER,  
S2028_1, S2028_SUMMER, S2028_2, S2028_WINTER,  
S2029_1, S2029_SUMMER, S2029_2, S2029_WINTER,  
S2030_1, S2030_SUMMER, S2030_2, S2030_WINTER

### 예시:

- 2025년 1학기: S2025_1

# _23.07.11_

- 엑셀 업로드
- 업로드한 입사생 목록 전체조회

현재 로그인기능 없음. 위의 두 기능만 존재
